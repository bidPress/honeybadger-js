{"version":3,"file":"honeybadger.js","sources":["../src/builder.js","../src/main.js"],"sourcesContent":["export default function builder() {\n  var VERSION = '__VERSION__',\n      NOTIFIER = {\n        name: 'honeybadger.js',\n        url: 'https://github.com/honeybadger-io/honeybadger-js',\n        version: VERSION,\n        language: 'javascript'\n      };\n\n  // Used to control initial setup across clients.\n  var loaded = false,\n      installed = false;\n\n  // Used to prevent reporting duplicate errors across instances.\n  var currentErr,\n      currentPayload;\n\n  // Utilities.\n  function merge(obj1, obj2) {\n    var obj3 = {};\n    for (var k in obj1) { obj3[k] = obj1[k]; }\n    for (var k in obj2) { obj3[k] = obj2[k]; }\n    return obj3;\n  }\n\n  function mergeErr(err1, err2) {\n    let ret = merge(err1, err2);\n\n    if (err1.context && err2.context) {\n      ret.context = merge(err1.context, err2.context);\n    }\n\n    return ret;\n  }\n\n  function currentErrIs(err) {\n    if (!currentErr) { return false; }\n    if (currentErr.name !== err.name) { return false; }\n    if (currentErr.message !== err.message) { return false; }\n    if (currentErr.stack !== err.stack) { return false; }\n    return true;\n  }\n\n  function isIgnored(err, patterns) {\n    var msg = err.message;\n\n    for (var p in patterns) {\n      if (msg.match(patterns[p])) { return true; }\n    }\n\n    return false;\n  }\n\n  function isFirefox() {\n    return navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n  }\n\n  function cgiData() {\n    var data = {};\n    data['HTTP_USER_AGENT'] = navigator.userAgent;\n    if (document.referrer.match(/\\S/)) {\n      data['HTTP_REFERER'] = document.referrer;\n    }\n    return data;\n  }\n\n  function encodeCookie(object) {\n    if (typeof object !== 'object') {\n      return undefined;\n    }\n\n    var cookies = [];\n    for (var k in object) {\n      cookies.push(k + '=' + object[k]);\n    }\n\n    return cookies.join(';');\n  }\n\n  function stackTrace(err) {\n    // From TraceKit: Opera 10 *destroys* its stacktrace property if you try to\n    // access the stack property first.\n    return err.stacktrace || err.stack || undefined\n  }\n\n  function generateStackTrace(err) {\n    var stack;\n    var maxStackSize = 10;\n\n    if (err && (stack = stackTrace(err))) {\n      return {stack: stack, generator: undefined};\n    }\n\n    try {\n      throw new Error('');\n    } catch(e) {\n      if (stack = stackTrace(e)) {\n        return {stack: stack, generator: 'throw'};\n      }\n    }\n\n    stack = ['<call-stack>'];\n    var curr = arguments.callee;\n    while (curr && stack.length < maxStackSize) {\n      if (/function(?:\\s+([\\w$]+))+\\s*\\(/.test(curr.toString())) {\n        stack.push(RegExp.$1 || '<anonymous>');\n      } else {\n        stack.push('<anonymous>');\n      }\n      try {\n        curr = curr.caller;\n      } catch (e) {\n        break;\n      }\n    }\n\n    return {stack: stack.join('\\n'), generator: 'walk'};\n  }\n\n  function checkHandlers(handlers, err) {\n    var handler, i, len;\n    for (i = 0, len = handlers.length; i < len; i++) {\n      handler = handlers[i];\n      if (handler(err) === false) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  // Client factory.\n  var factory = (function(opts) {\n    var notSingleton = installed;\n    var defaultProps = [];\n    var queue = [];\n    var self = {\n      context: {},\n      beforeNotifyHandlers: [],\n      errorsSent: 0\n    }\n    if (typeof opts === 'object') {\n      for (var k in opts) { self[k] = opts[k]; }\n    }\n\n    function log() {\n      var console = window.console;\n      if (console) {\n        var args = Array.prototype.slice.call(arguments);\n        args.unshift('[Honeybadger]');\n        console.log.apply(console, args);\n      }\n    }\n\n    function debug() {\n      if (config('debug')) {\n        return log.apply(this, arguments);\n      }\n    }\n\n    function config(key, fallback) {\n      var value = self[key];\n      if (value === undefined) { value = self[key.toLowerCase()] }\n      if (value === 'false') { value = false; }\n      if (value !== undefined) { return value; }\n      return fallback;\n    }\n\n    function onErrorEnabled() {\n      if (notSingleton) { return false; }\n      return config('onerror', true);\n    }\n\n    function baseURL() {\n      return 'http' + ((config('ssl', true) && 's') || '') + '://' + config('host', 'api.honeybadger.io');\n    }\n\n    function canSerialize(obj) {\n      // Functions are TMI and Symbols can't convert to strings.\n      if (/function|symbol/.test(typeof(obj))) { return false; }\n\n      // No prototype, likely created with `Object.create(null)`.\n      if (typeof obj === 'object' && typeof obj.hasOwnProperty === 'undefined') { return false; }\n\n      return true;\n    }\n\n    function serialize(obj, depth) {\n      var k, v, ret;\n      ret = {};\n      if (!depth) { depth = 0; }\n      if (depth >= config('max_depth', 8)) {\n        return '[MAX DEPTH REACHED]';\n      }\n      for (k in obj) {\n        v = obj[k];\n        if (Object.prototype.hasOwnProperty.call(obj, k) && (k != null) && (v != null)) {\n          if (!canSerialize(v)) { v = Object.prototype.toString.call(v); }\n          ret[k] = (typeof v === 'object' ? serialize(v, depth+1) : v);\n        }\n      }\n      return ret;\n    }\n\n    function request(apiKey, payload) {\n      try {\n        var x = new XMLHttpRequest();\n        x.open('POST', baseURL() + '/v1/notices/js', config('async', true));\n\n        x.setRequestHeader('X-API-Key', apiKey);\n        x.setRequestHeader('Content-Type', 'application/json');\n        x.setRequestHeader('Accept', 'text/json, application/json');\n\n        x.send(JSON.stringify(serialize(payload)));\n      } catch(err) {\n        log('Unable to send error report: error while initializing request', err, payload);\n      }\n    }\n\n    function send(payload) {\n      currentErr = currentPayload = null;\n\n      if (config('disabled', false)) {\n        debug('Dropping notice: honeybadger.js is disabled', payload);\n        return false;\n      }\n\n      var apiKey = config('apiKey', config('api_key'));\n      if (!apiKey) {\n        log('Unable to send error report: no API key has been configured');\n        return false;\n      }\n\n      if (exceedsMaxErrors()) {\n        debug('Dropping notice: max errors exceeded', payload);\n        return false;\n      }\n\n      incrementErrorsCount();\n\n      request(apiKey, payload);\n\n      return true;\n    }\n\n    function notify(err, generated) {\n      if (!err) { err = {}; }\n\n      if (Object.prototype.toString.call(err) === '[object Error]') {\n        var e = err;\n        err = merge(err, {name: e.name, message: e.message, stack: stackTrace(e)})\n      }\n\n      if (!(typeof err === 'object')) {\n        var m = String(err);\n        err = {message: m};\n      }\n\n      if (currentErrIs(err)) {\n        // Skip the duplicate error.\n        return false;\n      } else if (currentPayload && loaded) {\n        // This is a different error, send the old one now.\n        send(currentPayload);\n      }\n\n      // Halt if err is empty.\n      if (((function() {\n        var k, results;\n        results = [];\n        for (k in err) {\n          if (!Object.prototype.hasOwnProperty.call(err, k)) continue;\n          results.push(k);\n        }\n        return results;\n      })()).length === 0) {\n        return false;\n      }\n\n      if (generated) {\n        err = merge(err, generated);\n      }\n\n      if (isIgnored(err, config('ignorePatterns'))) { return false; }\n\n      if (checkHandlers(self.beforeNotifyHandlers, err)) { return false; }\n\n      var data = cgiData();\n      if (typeof err.cookies === 'string') {\n        data['HTTP_COOKIE'] = err.cookies;\n      } else if (typeof err.cookies === 'object') {\n        data['HTTP_COOKIE'] = encodeCookie(err.cookies);\n      }\n\n      var payload = {\n        'notifier': NOTIFIER,\n        'error': {\n          'class': err.name || 'Error',\n          'message': err.message,\n          'backtrace': err.stack,\n          'generator': err.generator,\n          'fingerprint': err.fingerprint\n        },\n        'request': {\n          'url': err.url || document.URL,\n          'component': err.component || config('component'),\n          'action': err.action || config('action'),\n          'context': merge(self.context, err.context),\n          'cgi_data': data,\n          'params': err.params\n        },\n        'server': {\n          'project_root': err.projectRoot || err.project_root || config('projectRoot', config('project_root', window.location.protocol + '//' + window.location.host)),\n          'environment_name': err.environment || config('environment'),\n          'revision': err.revision || config('revision')\n        }\n      };\n\n      currentPayload = payload;\n      currentErr = err;\n\n      if (loaded) {\n        debug('Deferring notice', err, payload);\n        window.setTimeout(function(){\n          if (currentErrIs(err)) {\n            send(payload);\n          }\n        });\n      } else {\n        debug('Queuing notice', err, payload);\n        queue.push(payload);\n      }\n\n      return err;\n    }\n\n    function objectIsExtensible(obj) {\n      if (typeof Object.isExtensible !== 'function') { return true; }\n      return Object.isExtensible(obj);\n    }\n\n    var preferCatch = true;\n    // IE < 10\n    if (!window.atob) { preferCatch = false; }\n    // See https://developer.mozilla.org/en-US/docs/Web/API/ErrorEvent\n    if (window.ErrorEvent) {\n      try {\n        if ((new window.ErrorEvent('')).colno === 0) {\n          preferCatch = false;\n        }\n      } catch(_e) {}\n    }\n\n    // wrap always returns the same function so that callbacks can be removed via\n    // removeEventListener.\n    function wrap(fn, force) {\n      try {\n        if (typeof fn !== 'function') { return fn; }\n        if (!objectIsExtensible(fn))  { return fn; }\n        if (!fn.___hb) {\n          fn.___hb = function() {\n            var onerror = onErrorEnabled();\n            // Don't catch if the browser is old or supports the new error\n            // object and there is a window.onerror handler available instead.\n            if ((preferCatch && (onerror || force)) || (force && !onerror)) {\n              try {\n                return fn.apply(this, arguments);\n              } catch (e) {\n                notify(e);\n                throw(e);\n              }\n            } else {\n              return fn.apply(this, arguments);\n            }\n          };\n        }\n        fn.___hb.___hb = fn.___hb;\n        return fn.___hb;\n      } catch(_e) {\n        return fn;\n      }\n    }\n\n    // Public API.\n    self.notify = function(err, name, extra) {\n      if (!err) { err = {}; }\n\n      if (Object.prototype.toString.call(err) === '[object Error]') {\n        var e = err;\n        err = merge(err, {name: e.name, message: e.message, stack: stackTrace(e)})\n      }\n\n      if (!(typeof err === 'object')) {\n        var m = String(err);\n        err = {message: m};\n      }\n\n      if (name && !(typeof name === 'object')) {\n        var n = String(name);\n        name = {name: n};\n      }\n\n      if (name) {\n        err = mergeErr(err, name);\n      }\n      if (typeof extra === 'object') {\n        err = mergeErr(err, extra);\n      }\n\n      return notify(err, generateStackTrace(err));\n    };\n\n    self.wrap = function(func) {\n      return wrap(func, true);\n    };\n\n    self.setContext = function(context) {\n      if (typeof context === 'object') {\n        self.context = merge(self.context, context);\n      }\n      return self;\n    };\n\n    self.resetContext = function(context) {\n      if (typeof context === 'object') {\n        self.context = merge({}, context);\n      } else {\n        self.context = {};\n      }\n      return self;\n    };\n\n    self.configure = function(opts) {\n      for (var k in opts) {\n        self[k] = opts[k];\n      }\n      return self;\n    };\n\n    self.beforeNotify = function(handler) {\n      self.beforeNotifyHandlers.push(handler);\n      return self;\n    };\n\n    var indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n    self.reset = function() {\n      self.context = {};\n      self.beforeNotifyHandlers = [];\n      for (var k in self) {\n        if (indexOf.call(defaultProps, k) == -1) {\n          self[k] = undefined;\n        }\n      }\n      self.resetMaxErrors();\n      return self;\n    };\n\n    self.resetMaxErrors = function() {\n      return (self.errorsSent=0);\n    };\n\n    self.getVersion = function() {\n      return VERSION;\n    }\n\n    // Install instrumentation.\n    // This should happen once for the first factory call.\n    function instrument(object, name, replacement) {\n      if (notSingleton) { return; }\n      if (!object || !name || !replacement) { return; }\n      var original = object[name];\n      object[name] = replacement(original);\n    }\n\n    var instrumentTimer = function(original) {\n      // See https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setTimeout\n      return function(func, delay) {\n        if (typeof func === 'function') {\n          var args = Array.prototype.slice.call(arguments, 2);\n          func = wrap(func);\n          return original(function() {\n            func.apply(null, args);\n          }, delay);\n        } else {\n          return original(func, delay);\n        }\n      }\n    };\n    instrument(window, 'setTimeout', instrumentTimer);\n    instrument(window, 'setInterval', instrumentTimer);\n\n    // Event targets borrowed from bugsnag-js:\n    // See https://github.com/bugsnag/bugsnag-js/blob/d55af916a4d3c7757f979d887f9533fe1a04cc93/src/bugsnag.js#L542\n    'EventTarget Window Node ApplicationCache AudioTrackList ChannelMergerNode CryptoOperation EventSource FileReader HTMLUnknownElement IDBDatabase IDBRequest IDBTransaction KeyOperation MediaController MessagePort ModalWindow Notification SVGElementInstance Screen TextTrack TextTrackCue TextTrackList WebSocket WebSocketWorker Worker XMLHttpRequest XMLHttpRequestEventTarget XMLHttpRequestUpload'.replace(/\\w+/g, function (prop) {\n      var prototype = window[prop] && window[prop].prototype;\n      if (prototype && prototype.hasOwnProperty && prototype.hasOwnProperty('addEventListener')) {\n        instrument(prototype, 'addEventListener', function(original) {\n          // See https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener\n          return function(type, listener, useCapture, wantsUntrusted) {\n            try {\n              if (listener && listener.handleEvent != null) {\n                listener.handleEvent = wrap(listener.handleEvent);\n              }\n            } catch(e) {\n              // Ignore 'Permission denied to access property \"handleEvent\"' errors.\n              log(e);\n            }\n            return original.call(this, type, wrap(listener), useCapture, wantsUntrusted);\n          };\n        });\n        instrument(prototype, 'removeEventListener', function(original) {\n          return function(type, listener, useCapture, wantsUntrusted) {\n            original.call(this, type, listener, useCapture, wantsUntrusted);\n            return original.call(this, type, wrap(listener), useCapture, wantsUntrusted);\n          };\n        });\n      }\n    });\n\n    if(!isFirefox()) {\n      instrument(window, 'onerror', function(original) {\n        function onerror(msg, url, line, col, err) {\n          debug('window.onerror callback invoked', arguments);\n\n          // Skip if the error is already being sent.\n          if (currentErr) { return; }\n\n          if (!onErrorEnabled()) { return; }\n\n          if (line === 0 && /Script error\\.?/.test(msg)) {\n            // See https://developer.mozilla.org/en/docs/Web/API/GlobalEventHandlers/onerror#Notes\n            log('Ignoring cross-domain script error: enable CORS to track these types of errors', arguments);\n            return;\n          }\n\n          // simulate v8 stack\n          var stack = [msg, '\\n    at ? (', url || 'unknown', ':', line || 0, ':', col || 0, ')'].join('');\n\n          if (err) {\n            var generated = { stack: stackTrace(err) };\n            if (!generated.stack) { generated = {stack: stack}; }\n            notify(err, generated);\n            return;\n          }\n\n          notify({\n            name: 'window.onerror',\n            message: msg,\n            stack: stack\n          });\n        }\n        // See https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/onerror\n        return function(msg, url, line, col, err) {\n          onerror(msg, url, line, col, err);\n          if (typeof original === 'function' && config('_onerror_call_orig', true)) {\n            return original.apply(this, arguments);\n          }\n          return false;\n        };\n      });\n    }\n\n    function incrementErrorsCount() {\n      return self.errorsSent++;\n    }\n\n    function exceedsMaxErrors() {\n      var maxErrors = config('maxErrors');\n      return maxErrors && self.errorsSent >= maxErrors;\n    }\n\n    // End of instrumentation.\n    installed = true;\n\n    // Save original state for reset()\n    for (var k in self) {\n      defaultProps.push(k);\n    }\n\n    // Initialization.\n    debug('Initializing honeybadger.js ' + VERSION);\n\n    // See https://developer.mozilla.org/en-US/docs/Web/API/Document/readyState\n    // https://www.w3.org/TR/html5/dom.html#dom-document-readystate\n    // The 'loaded' state is for older versions of Safari.\n    if (/complete|interactive|loaded/.test(document.readyState)) {\n      loaded = true;\n      debug('honeybadger.js ' + VERSION + ' ready');\n    } else {\n      debug('Installing ready handler');\n      var domReady = function() {\n        loaded = true;\n        debug('honeybadger.js ' + VERSION + ' ready');\n        var notice;\n        while (notice = queue.pop()) {\n          send(notice);\n        }\n      };\n      if (document.addEventListener) {\n        document.addEventListener('DOMContentLoaded', domReady, true);\n      } else {\n        window.attachEvent('onload', domReady);\n      }\n    }\n\n    return self;\n  });\n\n  return factory;\n}\n","import builder from './builder.js'\n\nlet factory = builder()\nlet singleton = factory()\n\nsingleton.factory = factory\n\nexport default singleton\n"],"names":["builder","VERSION","NOTIFIER","name","url","version","language","loaded","installed","currentErr","currentPayload","merge","obj1","obj2","obj3","k","mergeErr","err1","err2","ret","context","currentErrIs","err","message","stack","isIgnored","patterns","msg","p","match","isFirefox","navigator","userAgent","toLowerCase","indexOf","cgiData","data","document","referrer","encodeCookie","object","undefined","cookies","push","join","stackTrace","stacktrace","generateStackTrace","maxStackSize","generator","Error","e","curr","arguments","callee","length","test","toString","RegExp","$1","caller","checkHandlers","handlers","handler","i","len","factory","opts","notSingleton","defaultProps","queue","self","beforeNotifyHandlers","errorsSent","log","console","window","args","Array","prototype","slice","call","unshift","apply","debug","config","key","fallback","value","onErrorEnabled","baseURL","canSerialize","obj","hasOwnProperty","serialize","depth","v","Object","request","apiKey","payload","x","XMLHttpRequest","open","setRequestHeader","send","JSON","stringify","exceedsMaxErrors","incrementErrorsCount","notify","generated","m","String","results","fingerprint","URL","component","action","params","projectRoot","project_root","location","protocol","host","environment","revision","setTimeout","objectIsExtensible","isExtensible","preferCatch","atob","ErrorEvent","colno","_e","wrap","fn","force","___hb","onerror","extra","n","func","setContext","resetContext","configure","beforeNotify","item","l","reset","resetMaxErrors","getVersion","instrument","replacement","original","instrumentTimer","delay","replace","prop","type","listener","useCapture","wantsUntrusted","handleEvent","line","col","maxErrors","readyState","domReady","notice","pop","addEventListener","attachEvent","singleton"],"mappings":"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"}