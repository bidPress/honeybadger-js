{"version":3,"file":"honeybadger.min.js","sources":["../src/main.js","../src/builder.js"],"sourcesContent":["import builder from './builder.js'\n\nlet factory = builder()\nlet singleton = factory()\n\nsingleton.factory = factory\n\nexport default singleton\n","export default function builder() {\n  var VERSION = '__VERSION__',\n      NOTIFIER = {\n        name: 'honeybadger.js',\n        url: 'https://github.com/honeybadger-io/honeybadger-js',\n        version: VERSION,\n        language: 'javascript'\n      };\n\n  // Used to control initial setup across clients.\n  var loaded = false,\n      installed = false;\n\n  // Used to prevent reporting duplicate errors across instances.\n  var currentErr,\n      currentPayload;\n\n  // Utilities.\n  function merge(obj1, obj2) {\n    var obj3 = {};\n    for (var k in obj1) { obj3[k] = obj1[k]; }\n    for (var k in obj2) { obj3[k] = obj2[k]; }\n    return obj3;\n  }\n\n  function mergeErr(err1, err2) {\n    let ret = merge(err1, err2);\n\n    if (err1.context && err2.context) {\n      ret.context = merge(err1.context, err2.context);\n    }\n\n    return ret;\n  }\n\n  function currentErrIs(err) {\n    if (!currentErr) { return false; }\n    if (currentErr.name !== err.name) { return false; }\n    if (currentErr.message !== err.message) { return false; }\n    if (currentErr.stack !== err.stack) { return false; }\n    return true;\n  }\n\n  function isIgnored(err, patterns) {\n    var msg = err.message;\n\n    for (var p in patterns) {\n      if (msg.match(patterns[p])) { return true; }\n    }\n\n    return false;\n  }\n\n  function isFirefox() {\n    return navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n  }\n\n  function cgiData() {\n    var data = {};\n    data['HTTP_USER_AGENT'] = navigator.userAgent;\n    if (document.referrer.match(/\\S/)) {\n      data['HTTP_REFERER'] = document.referrer;\n    }\n    return data;\n  }\n\n  function encodeCookie(object) {\n    if (typeof object !== 'object') {\n      return undefined;\n    }\n\n    var cookies = [];\n    for (var k in object) {\n      cookies.push(k + '=' + object[k]);\n    }\n\n    return cookies.join(';');\n  }\n\n  function stackTrace(err) {\n    // From TraceKit: Opera 10 *destroys* its stacktrace property if you try to\n    // access the stack property first.\n    return err.stacktrace || err.stack || undefined\n  }\n\n  function generateStackTrace(err) {\n    var stack;\n    var maxStackSize = 10;\n\n    if (err && (stack = stackTrace(err))) {\n      return {stack: stack, generator: undefined};\n    }\n\n    try {\n      throw new Error('');\n    } catch(e) {\n      if (stack = stackTrace(e)) {\n        return {stack: stack, generator: 'throw'};\n      }\n    }\n\n    stack = ['<call-stack>'];\n    var curr = arguments.callee;\n    while (curr && stack.length < maxStackSize) {\n      if (/function(?:\\s+([\\w$]+))+\\s*\\(/.test(curr.toString())) {\n        stack.push(RegExp.$1 || '<anonymous>');\n      } else {\n        stack.push('<anonymous>');\n      }\n      try {\n        curr = curr.caller;\n      } catch (e) {\n        break;\n      }\n    }\n\n    return {stack: stack.join('\\n'), generator: 'walk'};\n  }\n\n  function checkHandlers(handlers, err) {\n    var handler, i, len;\n    for (i = 0, len = handlers.length; i < len; i++) {\n      handler = handlers[i];\n      if (handler(err) === false) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  // Client factory.\n  var factory = (function(opts) {\n    var notSingleton = installed;\n    var defaultProps = [];\n    var queue = [];\n    var self = {\n      context: {},\n      beforeNotifyHandlers: [],\n      errorsSent: 0\n    }\n    if (typeof opts === 'object') {\n      for (var k in opts) { self[k] = opts[k]; }\n    }\n\n    function log() {\n      var console = window.console;\n      if (console) {\n        var args = Array.prototype.slice.call(arguments);\n        args.unshift('[Honeybadger]');\n        console.log.apply(console, args);\n      }\n    }\n\n    function debug() {\n      if (config('debug')) {\n        return log.apply(this, arguments);\n      }\n    }\n\n    function config(key, fallback) {\n      var value = self[key];\n      if (value === undefined) { value = self[key.toLowerCase()] }\n      if (value === 'false') { value = false; }\n      if (value !== undefined) { return value; }\n      return fallback;\n    }\n\n    function onErrorEnabled() {\n      if (notSingleton) { return false; }\n      return config('onerror', true);\n    }\n\n    function baseURL() {\n      return 'http' + ((config('ssl', true) && 's') || '') + '://' + config('host', 'api.honeybadger.io');\n    }\n\n    function canSerialize(obj) {\n      // Functions are TMI and Symbols can't convert to strings.\n      if (/function|symbol/.test(typeof(obj))) { return false; }\n\n      // No prototype, likely created with `Object.create(null)`.\n      if (typeof obj === 'object' && typeof obj.hasOwnProperty === 'undefined') { return false; }\n\n      return true;\n    }\n\n    function serialize(obj, depth) {\n      var k, v, ret;\n      ret = {};\n      if (!depth) { depth = 0; }\n      if (depth >= config('max_depth', 8)) {\n        return '[MAX DEPTH REACHED]';\n      }\n      for (k in obj) {\n        v = obj[k];\n        if (Object.prototype.hasOwnProperty.call(obj, k) && (k != null) && (v != null)) {\n          if (!canSerialize(v)) { v = Object.prototype.toString.call(v); }\n          ret[k] = (typeof v === 'object' ? serialize(v, depth+1) : v);\n        }\n      }\n      return ret;\n    }\n\n    function request(apiKey, payload) {\n      try {\n        var x = new XMLHttpRequest();\n        x.open('POST', baseURL() + '/v1/notices/js', config('async', true));\n\n        x.setRequestHeader('X-API-Key', apiKey);\n        x.setRequestHeader('Content-Type', 'application/json');\n        x.setRequestHeader('Accept', 'text/json, application/json');\n\n        x.send(JSON.stringify(serialize(payload)));\n      } catch(err) {\n        log('Unable to send error report: error while initializing request', err, payload);\n      }\n    }\n\n    function send(payload) {\n      currentErr = currentPayload = null;\n\n      if (config('disabled', false)) {\n        debug('Dropping notice: honeybadger.js is disabled', payload);\n        return false;\n      }\n\n      var apiKey = config('apiKey', config('api_key'));\n      if (!apiKey) {\n        log('Unable to send error report: no API key has been configured');\n        return false;\n      }\n\n      if (exceedsMaxErrors()) {\n        debug('Dropping notice: max errors exceeded', payload);\n        return false;\n      }\n\n      incrementErrorsCount();\n\n      request(apiKey, payload);\n\n      return true;\n    }\n\n    function notify(err, generated) {\n      if (!err) { err = {}; }\n\n      if (Object.prototype.toString.call(err) === '[object Error]') {\n        var e = err;\n        err = merge(err, {name: e.name, message: e.message, stack: stackTrace(e)})\n      }\n\n      if (!(typeof err === 'object')) {\n        var m = String(err);\n        err = {message: m};\n      }\n\n      if (currentErrIs(err)) {\n        // Skip the duplicate error.\n        return false;\n      } else if (currentPayload && loaded) {\n        // This is a different error, send the old one now.\n        send(currentPayload);\n      }\n\n      // Halt if err is empty.\n      if (((function() {\n        var k, results;\n        results = [];\n        for (k in err) {\n          if (!Object.prototype.hasOwnProperty.call(err, k)) continue;\n          results.push(k);\n        }\n        return results;\n      })()).length === 0) {\n        return false;\n      }\n\n      if (generated) {\n        err = merge(err, generated);\n      }\n\n      if (isIgnored(err, config('ignorePatterns'))) { return false; }\n\n      if (checkHandlers(self.beforeNotifyHandlers, err)) { return false; }\n\n      var data = cgiData();\n      if (typeof err.cookies === 'string') {\n        data['HTTP_COOKIE'] = err.cookies;\n      } else if (typeof err.cookies === 'object') {\n        data['HTTP_COOKIE'] = encodeCookie(err.cookies);\n      }\n\n      var payload = {\n        'notifier': NOTIFIER,\n        'error': {\n          'class': err.name || 'Error',\n          'message': err.message,\n          'backtrace': err.stack,\n          'generator': err.generator,\n          'fingerprint': err.fingerprint\n        },\n        'request': {\n          'url': err.url || document.URL,\n          'component': err.component || config('component'),\n          'action': err.action || config('action'),\n          'context': merge(self.context, err.context),\n          'cgi_data': data,\n          'params': err.params\n        },\n        'server': {\n          'project_root': err.projectRoot || err.project_root || config('projectRoot', config('project_root', window.location.protocol + '//' + window.location.host)),\n          'environment_name': err.environment || config('environment'),\n          'revision': err.revision || config('revision')\n        }\n      };\n\n      currentPayload = payload;\n      currentErr = err;\n\n      if (loaded) {\n        debug('Deferring notice', err, payload);\n        window.setTimeout(function(){\n          if (currentErrIs(err)) {\n            send(payload);\n          }\n        });\n      } else {\n        debug('Queuing notice', err, payload);\n        queue.push(payload);\n      }\n\n      return err;\n    }\n\n    function objectIsExtensible(obj) {\n      if (typeof Object.isExtensible !== 'function') { return true; }\n      return Object.isExtensible(obj);\n    }\n\n    var preferCatch = true;\n    // IE < 10\n    if (!window.atob) { preferCatch = false; }\n    // See https://developer.mozilla.org/en-US/docs/Web/API/ErrorEvent\n    if (window.ErrorEvent) {\n      try {\n        if ((new window.ErrorEvent('')).colno === 0) {\n          preferCatch = false;\n        }\n      } catch(_e) {}\n    }\n\n    // wrap always returns the same function so that callbacks can be removed via\n    // removeEventListener.\n    function wrap(fn, force) {\n      try {\n        if (typeof fn !== 'function') { return fn; }\n        if (!objectIsExtensible(fn))  { return fn; }\n        if (!fn.___hb) {\n          fn.___hb = function() {\n            var onerror = onErrorEnabled();\n            // Don't catch if the browser is old or supports the new error\n            // object and there is a window.onerror handler available instead.\n            if ((preferCatch && (onerror || force)) || (force && !onerror)) {\n              try {\n                return fn.apply(this, arguments);\n              } catch (e) {\n                notify(e);\n                throw(e);\n              }\n            } else {\n              return fn.apply(this, arguments);\n            }\n          };\n        }\n        fn.___hb.___hb = fn.___hb;\n        return fn.___hb;\n      } catch(_e) {\n        return fn;\n      }\n    }\n\n    // Public API.\n    self.notify = function(err, name, extra) {\n      if (!err) { err = {}; }\n\n      if (Object.prototype.toString.call(err) === '[object Error]') {\n        var e = err;\n        err = merge(err, {name: e.name, message: e.message, stack: stackTrace(e)})\n      }\n\n      if (!(typeof err === 'object')) {\n        var m = String(err);\n        err = {message: m};\n      }\n\n      if (name && !(typeof name === 'object')) {\n        var n = String(name);\n        name = {name: n};\n      }\n\n      if (name) {\n        err = mergeErr(err, name);\n      }\n      if (typeof extra === 'object') {\n        err = mergeErr(err, extra);\n      }\n\n      return notify(err, generateStackTrace(err));\n    };\n\n    self.wrap = function(func) {\n      return wrap(func, true);\n    };\n\n    self.setContext = function(context) {\n      if (typeof context === 'object') {\n        self.context = merge(self.context, context);\n      }\n      return self;\n    };\n\n    self.resetContext = function(context) {\n      if (typeof context === 'object') {\n        self.context = merge({}, context);\n      } else {\n        self.context = {};\n      }\n      return self;\n    };\n\n    self.configure = function(opts) {\n      for (var k in opts) {\n        self[k] = opts[k];\n      }\n      return self;\n    };\n\n    self.beforeNotify = function(handler) {\n      self.beforeNotifyHandlers.push(handler);\n      return self;\n    };\n\n    var indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n    self.reset = function() {\n      self.context = {};\n      self.beforeNotifyHandlers = [];\n      for (var k in self) {\n        if (indexOf.call(defaultProps, k) == -1) {\n          self[k] = undefined;\n        }\n      }\n      self.resetMaxErrors();\n      return self;\n    };\n\n    self.resetMaxErrors = function() {\n      return (self.errorsSent=0);\n    };\n\n    self.getVersion = function() {\n      return VERSION;\n    }\n\n    // Install instrumentation.\n    // This should happen once for the first factory call.\n    function instrument(object, name, replacement) {\n      if (notSingleton) { return; }\n      if (!object || !name || !replacement) { return; }\n      var original = object[name];\n      object[name] = replacement(original);\n    }\n\n    var instrumentTimer = function(original) {\n      // See https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setTimeout\n      return function(func, delay) {\n        if (typeof func === 'function') {\n          var args = Array.prototype.slice.call(arguments, 2);\n          func = wrap(func);\n          return original(function() {\n            func.apply(null, args);\n          }, delay);\n        } else {\n          return original(func, delay);\n        }\n      }\n    };\n    instrument(window, 'setTimeout', instrumentTimer);\n    instrument(window, 'setInterval', instrumentTimer);\n\n    // Event targets borrowed from bugsnag-js:\n    // See https://github.com/bugsnag/bugsnag-js/blob/d55af916a4d3c7757f979d887f9533fe1a04cc93/src/bugsnag.js#L542\n    'EventTarget Window Node ApplicationCache AudioTrackList ChannelMergerNode CryptoOperation EventSource FileReader HTMLUnknownElement IDBDatabase IDBRequest IDBTransaction KeyOperation MediaController MessagePort ModalWindow Notification SVGElementInstance Screen TextTrack TextTrackCue TextTrackList WebSocket WebSocketWorker Worker XMLHttpRequest XMLHttpRequestEventTarget XMLHttpRequestUpload'.replace(/\\w+/g, function (prop) {\n      var prototype = window[prop] && window[prop].prototype;\n      if (prototype && prototype.hasOwnProperty && prototype.hasOwnProperty('addEventListener')) {\n        instrument(prototype, 'addEventListener', function(original) {\n          // See https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener\n          return function(type, listener, useCapture, wantsUntrusted) {\n            try {\n              if (listener && listener.handleEvent != null) {\n                listener.handleEvent = wrap(listener.handleEvent);\n              }\n            } catch(e) {\n              // Ignore 'Permission denied to access property \"handleEvent\"' errors.\n              log(e);\n            }\n            return original.call(this, type, wrap(listener), useCapture, wantsUntrusted);\n          };\n        });\n        instrument(prototype, 'removeEventListener', function(original) {\n          return function(type, listener, useCapture, wantsUntrusted) {\n            original.call(this, type, listener, useCapture, wantsUntrusted);\n            return original.call(this, type, wrap(listener), useCapture, wantsUntrusted);\n          };\n        });\n      }\n    });\n\n    if(!isFirefox()) {\n      instrument(window, 'onerror', function(original) {\n        function onerror(msg, url, line, col, err) {\n          debug('window.onerror callback invoked', arguments);\n\n          // Skip if the error is already being sent.\n          if (currentErr) { return; }\n\n          if (!onErrorEnabled()) { return; }\n\n          if (line === 0 && /Script error\\.?/.test(msg)) {\n            // See https://developer.mozilla.org/en/docs/Web/API/GlobalEventHandlers/onerror#Notes\n            log('Ignoring cross-domain script error: enable CORS to track these types of errors', arguments);\n            return;\n          }\n\n          // simulate v8 stack\n          var stack = [msg, '\\n    at ? (', url || 'unknown', ':', line || 0, ':', col || 0, ')'].join('');\n\n          if (err) {\n            var generated = { stack: stackTrace(err) };\n            if (!generated.stack) { generated = {stack: stack}; }\n            notify(err, generated);\n            return;\n          }\n\n          notify({\n            name: 'window.onerror',\n            message: msg,\n            stack: stack\n          });\n        }\n        // See https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/onerror\n        return function(msg, url, line, col, err) {\n          onerror(msg, url, line, col, err);\n          if (typeof original === 'function' && config('_onerror_call_orig', true)) {\n            return original.apply(this, arguments);\n          }\n          return false;\n        };\n      });\n    }\n\n    function incrementErrorsCount() {\n      return self.errorsSent++;\n    }\n\n    function exceedsMaxErrors() {\n      var maxErrors = config('maxErrors');\n      return maxErrors && self.errorsSent >= maxErrors;\n    }\n\n    // End of instrumentation.\n    installed = true;\n\n    // Save original state for reset()\n    for (var k in self) {\n      defaultProps.push(k);\n    }\n\n    // Initialization.\n    debug('Initializing honeybadger.js ' + VERSION);\n\n    // See https://developer.mozilla.org/en-US/docs/Web/API/Document/readyState\n    // https://www.w3.org/TR/html5/dom.html#dom-document-readystate\n    // The 'loaded' state is for older versions of Safari.\n    if (/complete|interactive|loaded/.test(document.readyState)) {\n      loaded = true;\n      debug('honeybadger.js ' + VERSION + ' ready');\n    } else {\n      debug('Installing ready handler');\n      var domReady = function() {\n        loaded = true;\n        debug('honeybadger.js ' + VERSION + ' ready');\n        var notice;\n        while (notice = queue.pop()) {\n          send(notice);\n        }\n      };\n      if (document.addEventListener) {\n        document.addEventListener('DOMContentLoaded', domReady, true);\n      } else {\n        window.attachEvent('onload', domReady);\n      }\n    }\n\n    return self;\n  });\n\n  return factory;\n}\n"],"names":["factory","currentErr","currentPayload","VERSION","NOTIFIER","name","url","version","language","loaded","installed","merge","obj1","obj2","obj3","k","mergeErr","err1","err2","ret","context","currentErrIs","err","message","stack","stackTrace","stacktrace","undefined","opts","notSingleton","defaultProps","queue","self","beforeNotifyHandlers","errorsSent","_typeof","log","console","window","args","Array","prototype","slice","call","arguments","unshift","apply","debug","config","this","key","fallback","value","toLowerCase","onErrorEnabled","request","apiKey","payload","x","XMLHttpRequest","open","setRequestHeader","send","JSON","stringify","serialize","obj","depth","v","Object","hasOwnProperty","test","toString","maxErrors","notify","generated","e","m","String","results","push","length","patterns","msg","p","match","isIgnored","handlers","i","len","handler","checkHandlers","data","navigator","userAgent","document","referrer","cookies","object","join","encodeCookie","generator","fingerprint","URL","component","action","params","projectRoot","project_root","location","protocol","host","environment","revision","setTimeout","preferCatch","atob","ErrorEvent","colno","_e","wrap","fn","force","isExtensible","___hb","onerror","extra","Error","curr","callee","RegExp","$1","caller","generateStackTrace","func","setContext","resetContext","configure","beforeNotify","indexOf","item","l","instrument","replacement","original","reset","resetMaxErrors","getVersion","instrumentTimer","delay","replace","prop","type","listener","useCapture","wantsUntrusted","handleEvent","line","col","readyState","domReady","notice","pop","addEventListener","attachEvent","builder","singleton"],"mappings":"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"}