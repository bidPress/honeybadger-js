{"version":3,"file":"honeybadger.min.js","sources":["../src/main.js","../src/builder.js"],"sourcesContent":["import builder from './builder.js'\n\nlet factory = builder()\nlet singleton = factory()\n\nsingleton.factory = factory\n\nexport default singleton\n","export default function builder() {\n  var VERSION = '__VERSION__',\n      NOTIFIER = {\n        name: 'honeybadger.js',\n        url: 'https://github.com/honeybadger-io/honeybadger-js',\n        version: VERSION,\n        language: 'javascript'\n      };\n\n  // Used to control initial setup across clients.\n  var loaded = false,\n      installed = false;\n\n  // Used to prevent reporting duplicate errors across instances.\n  var currentErr,\n      currentPayload;\n\n  // Utilities.\n  function merge(obj1, obj2) {\n    var obj3 = {};\n    for (var k in obj1) { obj3[k] = obj1[k]; }\n    for (var k in obj2) { obj3[k] = obj2[k]; }\n    return obj3;\n  }\n\n  function mergeErr(err1, err2) {\n    let ret = merge(err1, err2);\n\n    if (err1.context && err2.context) {\n      ret.context = merge(err1.context, err2.context);\n    }\n\n    return ret;\n  }\n\n  function currentErrIs(err) {\n    if (!currentErr) { return false; }\n    if (currentErr.name !== err.name) { return false; }\n    if (currentErr.message !== err.message) { return false; }\n    if (currentErr.stack !== err.stack) { return false; }\n    return true;\n  }\n\n  function isIgnored(err, patterns) {\n    var msg = err.message;\n\n    for (var p in patterns) {\n      if (msg.match(patterns[p])) { return true; }\n    }\n\n    return false;\n  }\n\n  function isFirefox() {\n    return navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n  }\n\n  function cgiData() {\n    var data = {};\n    data['HTTP_USER_AGENT'] = navigator.userAgent;\n    if (document.referrer.match(/\\S/)) {\n      data['HTTP_REFERER'] = document.referrer;\n    }\n    return data;\n  }\n\n  function encodeCookie(object) {\n    if (typeof object !== 'object') {\n      return undefined;\n    }\n\n    var cookies = [];\n    for (var k in object) {\n      cookies.push(k + '=' + object[k]);\n    }\n\n    return cookies.join(';');\n  }\n\n  function stackTrace(err) {\n    // From TraceKit: Opera 10 *destroys* its stacktrace property if you try to\n    // access the stack property first.\n    return err.stacktrace || err.stack || undefined\n  }\n\n  function generateStackTrace(err) {\n    var stack;\n    var maxStackSize = 10;\n\n    if (err && (stack = stackTrace(err))) {\n      return {stack: stack, generator: undefined};\n    }\n\n    try {\n      throw new Error('');\n    } catch(e) {\n      if (stack = stackTrace(e)) {\n        return {stack: stack, generator: 'throw'};\n      }\n    }\n\n    stack = ['<call-stack>'];\n    var curr = arguments.callee;\n    while (curr && stack.length < maxStackSize) {\n      if (/function(?:\\s+([\\w$]+))+\\s*\\(/.test(curr.toString())) {\n        stack.push(RegExp.$1 || '<anonymous>');\n      } else {\n        stack.push('<anonymous>');\n      }\n      try {\n        curr = curr.caller;\n      } catch (e) {\n        break;\n      }\n    }\n\n    return {stack: stack.join('\\n'), generator: 'walk'};\n  }\n\n  function checkHandlers(handlers, err) {\n    var handler, i, len;\n    for (i = 0, len = handlers.length; i < len; i++) {\n      handler = handlers[i];\n      if (handler(err) === false) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  // Client factory.\n  var factory = (function(opts) {\n    var notSingleton = installed;\n    var defaultProps = [];\n    var queue = [];\n    var self = {\n      context: {},\n      beforeNotifyHandlers: [],\n      errorsSent: 0\n    }\n    if (typeof opts === 'object') {\n      for (var k in opts) { self[k] = opts[k]; }\n    }\n\n    function log() {\n      var console = window.console;\n      if (console) {\n        var args = Array.prototype.slice.call(arguments);\n        args.unshift('[Honeybadger]');\n        console.log.apply(console, args);\n      }\n    }\n\n    function debug() {\n      if (config('debug')) {\n        return log.apply(this, arguments);\n      }\n    }\n\n    function config(key, fallback) {\n      var value = self[key];\n      if (value === undefined) { value = self[key.toLowerCase()] }\n      if (value === 'false') { value = false; }\n      if (value !== undefined) { return value; }\n      return fallback;\n    }\n\n    function onErrorEnabled() {\n      if (notSingleton) { return false; }\n      return config('onerror', true);\n    }\n\n    function baseURL() {\n      return 'https://api.honeybadger.io';\n    }\n\n    function canSerialize(obj) {\n      // Functions are TMI and Symbols can't convert to strings.\n      if (/function|symbol/.test(typeof(obj))) { return false; }\n\n      // No prototype, likely created with `Object.create(null)`.\n      if (typeof obj === 'object' && typeof obj.hasOwnProperty === 'undefined') { return false; }\n\n      return true;\n    }\n\n    function serialize(obj, depth) {\n      var k, v, ret;\n      ret = {};\n      if (!depth) { depth = 0; }\n      if (depth >= config('max_depth', 8)) {\n        return '[MAX DEPTH REACHED]';\n      }\n      for (k in obj) {\n        v = obj[k];\n        if (Object.prototype.hasOwnProperty.call(obj, k) && (k != null) && (v != null)) {\n          if (!canSerialize(v)) { v = Object.prototype.toString.call(v); }\n          ret[k] = (typeof v === 'object' ? serialize(v, depth+1) : v);\n        }\n      }\n      return ret;\n    }\n\n    function request(apiKey, payload) {\n      try {\n        var x = new XMLHttpRequest();\n        x.open('POST', baseURL() + '/v1/notices/js', config('async', true));\n\n        x.setRequestHeader('X-API-Key', apiKey);\n        x.setRequestHeader('Content-Type', 'application/json');\n        x.setRequestHeader('Accept', 'text/json, application/json');\n\n        x.send(JSON.stringify(serialize(payload)));\n      } catch(err) {\n        log('Unable to send error report: error while initializing request', err, payload);\n      }\n    }\n\n    function send(payload) {\n      currentErr = currentPayload = null;\n\n      if (config('disabled', false)) {\n        debug('Dropping notice: honeybadger.js is disabled', payload);\n        return false;\n      }\n\n      var apiKey = config('apiKey', config('api_key'));\n      if (!apiKey) {\n        log('Unable to send error report: no API key has been configured');\n        return false;\n      }\n\n      if (exceedsMaxErrors()) {\n        debug('Dropping notice: max errors exceeded', payload);\n        return false;\n      }\n\n      incrementErrorsCount();\n\n      request(apiKey, payload);\n\n      return true;\n    }\n\n    function notify(err, generated) {\n      if (!err) { err = {}; }\n\n      if (Object.prototype.toString.call(err) === '[object Error]') {\n        var e = err;\n        err = merge(err, {name: e.name, message: e.message, stack: stackTrace(e)})\n      }\n\n      if (!(typeof err === 'object')) {\n        var m = String(err);\n        err = {message: m};\n      }\n\n      if (currentErrIs(err)) {\n        // Skip the duplicate error.\n        return false;\n      } else if (currentPayload && loaded) {\n        // This is a different error, send the old one now.\n        send(currentPayload);\n      }\n\n      // Halt if err is empty.\n      if (((function() {\n        var k, results;\n        results = [];\n        for (k in err) {\n          if (!Object.prototype.hasOwnProperty.call(err, k)) continue;\n          results.push(k);\n        }\n        return results;\n      })()).length === 0) {\n        return false;\n      }\n\n      if (generated) {\n        err = merge(err, generated);\n      }\n\n      if (isIgnored(err, config('ignorePatterns'))) { return false; }\n\n      if (checkHandlers(self.beforeNotifyHandlers, err)) { return false; }\n\n      var data = cgiData();\n      if (typeof err.cookies === 'string') {\n        data['HTTP_COOKIE'] = err.cookies;\n      } else if (typeof err.cookies === 'object') {\n        data['HTTP_COOKIE'] = encodeCookie(err.cookies);\n      }\n\n      var payload = {\n        'notifier': NOTIFIER,\n        'error': {\n          'class': err.name || 'Error',\n          'message': err.message,\n          'backtrace': err.stack,\n          'generator': err.generator,\n          'fingerprint': err.fingerprint\n        },\n        'request': {\n          'url': err.url || document.URL,\n          'component': err.component || config('component'),\n          'action': err.action || config('action'),\n          'context': merge(self.context, err.context),\n          'cgi_data': data,\n          'params': err.params\n        },\n        'server': {\n          'project_root': err.projectRoot || err.project_root || config('projectRoot', config('project_root', window.location.protocol + '//' + window.location.host)),\n          'environment_name': err.environment || config('environment'),\n          'revision': err.revision || config('revision')\n        }\n      };\n\n      currentPayload = payload;\n      currentErr = err;\n\n      if (loaded) {\n        debug('Deferring notice', err, payload);\n        window.setTimeout(function(){\n          if (currentErrIs(err)) {\n            send(payload);\n          }\n        });\n      } else {\n        debug('Queuing notice', err, payload);\n        queue.push(payload);\n      }\n\n      return err;\n    }\n\n    function objectIsExtensible(obj) {\n      if (typeof Object.isExtensible !== 'function') { return true; }\n      return Object.isExtensible(obj);\n    }\n\n    var preferCatch = true;\n    // IE < 10\n    if (!window.atob) { preferCatch = false; }\n    // See https://developer.mozilla.org/en-US/docs/Web/API/ErrorEvent\n    if (window.ErrorEvent) {\n      try {\n        if ((new window.ErrorEvent('')).colno === 0) {\n          preferCatch = false;\n        }\n      } catch(_e) {}\n    }\n\n    // wrap always returns the same function so that callbacks can be removed via\n    // removeEventListener.\n    function wrap(fn, force) {\n      try {\n        if (typeof fn !== 'function') { return fn; }\n        if (!objectIsExtensible(fn))  { return fn; }\n        if (!fn.___hb) {\n          fn.___hb = function() {\n            var onerror = onErrorEnabled();\n            // Don't catch if the browser is old or supports the new error\n            // object and there is a window.onerror handler available instead.\n            if ((preferCatch && (onerror || force)) || (force && !onerror)) {\n              try {\n                return fn.apply(this, arguments);\n              } catch (e) {\n                notify(e);\n                throw(e);\n              }\n            } else {\n              return fn.apply(this, arguments);\n            }\n          };\n        }\n        fn.___hb.___hb = fn.___hb;\n        return fn.___hb;\n      } catch(_e) {\n        return fn;\n      }\n    }\n\n    // Public API.\n    self.notify = function(err, name, extra) {\n      if (!err) { err = {}; }\n\n      if (Object.prototype.toString.call(err) === '[object Error]') {\n        var e = err;\n        err = merge(err, {name: e.name, message: e.message, stack: stackTrace(e)})\n      }\n\n      if (!(typeof err === 'object')) {\n        var m = String(err);\n        err = {message: m};\n      }\n\n      if (name && !(typeof name === 'object')) {\n        var n = String(name);\n        name = {name: n};\n      }\n\n      if (name) {\n        err = mergeErr(err, name);\n      }\n      if (typeof extra === 'object') {\n        err = mergeErr(err, extra);\n      }\n\n      return notify(err, generateStackTrace(err));\n    };\n\n    self.wrap = function(func) {\n      return wrap(func, true);\n    };\n\n    self.setContext = function(context) {\n      if (typeof context === 'object') {\n        self.context = merge(self.context, context);\n      }\n      return self;\n    };\n\n    self.resetContext = function(context) {\n      if (typeof context === 'object') {\n        self.context = merge({}, context);\n      } else {\n        self.context = {};\n      }\n      return self;\n    };\n\n    self.configure = function(opts) {\n      for (var k in opts) {\n        self[k] = opts[k];\n      }\n      return self;\n    };\n\n    self.beforeNotify = function(handler) {\n      self.beforeNotifyHandlers.push(handler);\n      return self;\n    };\n\n    var indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\n    self.reset = function() {\n      self.context = {};\n      self.beforeNotifyHandlers = [];\n      for (var k in self) {\n        if (indexOf.call(defaultProps, k) == -1) {\n          self[k] = undefined;\n        }\n      }\n      self.resetMaxErrors();\n      return self;\n    };\n\n    self.resetMaxErrors = function() {\n      return (self.errorsSent=0);\n    };\n\n    self.getVersion = function() {\n      return VERSION;\n    }\n\n    // Install instrumentation.\n    // This should happen once for the first factory call.\n    function instrument(object, name, replacement) {\n      if (notSingleton) { return; }\n      if (!object || !name || !replacement) { return; }\n      var original = object[name];\n      object[name] = replacement(original);\n    }\n\n    var instrumentTimer = function(original) {\n      // See https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setTimeout\n      return function(func, delay) {\n        if (typeof func === 'function') {\n          var args = Array.prototype.slice.call(arguments, 2);\n          func = wrap(func);\n          return original(function() {\n            func.apply(null, args);\n          }, delay);\n        } else {\n          return original(func, delay);\n        }\n      }\n    };\n    instrument(window, 'setTimeout', instrumentTimer);\n    instrument(window, 'setInterval', instrumentTimer);\n\n    // Event targets borrowed from bugsnag-js:\n    // See https://github.com/bugsnag/bugsnag-js/blob/d55af916a4d3c7757f979d887f9533fe1a04cc93/src/bugsnag.js#L542\n    'EventTarget Window Node ApplicationCache AudioTrackList ChannelMergerNode CryptoOperation EventSource FileReader HTMLUnknownElement IDBDatabase IDBRequest IDBTransaction KeyOperation MediaController MessagePort ModalWindow Notification SVGElementInstance Screen TextTrack TextTrackCue TextTrackList WebSocket WebSocketWorker Worker XMLHttpRequest XMLHttpRequestEventTarget XMLHttpRequestUpload'.replace(/\\w+/g, function (prop) {\n      var prototype = window[prop] && window[prop].prototype;\n      if (prototype && prototype.hasOwnProperty && prototype.hasOwnProperty('addEventListener')) {\n        instrument(prototype, 'addEventListener', function(original) {\n          // See https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener\n          return function(type, listener, useCapture, wantsUntrusted) {\n            try {\n              if (listener && listener.handleEvent != null) {\n                listener.handleEvent = wrap(listener.handleEvent);\n              }\n            } catch(e) {\n              // Ignore 'Permission denied to access property \"handleEvent\"' errors.\n              log(e);\n            }\n            return original.call(this, type, wrap(listener), useCapture, wantsUntrusted);\n          };\n        });\n        instrument(prototype, 'removeEventListener', function(original) {\n          return function(type, listener, useCapture, wantsUntrusted) {\n            original.call(this, type, listener, useCapture, wantsUntrusted);\n            return original.call(this, type, wrap(listener), useCapture, wantsUntrusted);\n          };\n        });\n      }\n    });\n\n    if(!isFirefox()) {\n      instrument(window, 'onerror', function(original) {\n        function onerror(msg, url, line, col, err) {\n          debug('window.onerror callback invoked', arguments);\n\n          // Skip if the error is already being sent.\n          if (currentErr) { return; }\n\n          if (!onErrorEnabled()) { return; }\n\n          if (line === 0 && /Script error\\.?/.test(msg)) {\n            // See https://developer.mozilla.org/en/docs/Web/API/GlobalEventHandlers/onerror#Notes\n            log('Ignoring cross-domain script error: enable CORS to track these types of errors', arguments);\n            return;\n          }\n\n          // simulate v8 stack\n          var stack = [msg, '\\n    at ? (', url || 'unknown', ':', line || 0, ':', col || 0, ')'].join('');\n\n          if (err) {\n            var generated = { stack: stackTrace(err) };\n            if (!generated.stack) { generated = {stack: stack}; }\n            notify(err, generated);\n            return;\n          }\n\n          notify({\n            name: 'window.onerror',\n            message: msg,\n            stack: stack\n          });\n        }\n        // See https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/onerror\n        return function(msg, url, line, col, err) {\n          onerror(msg, url, line, col, err);\n          if (typeof original === 'function' && config('_onerror_call_orig', true)) {\n            return original.apply(this, arguments);\n          }\n          return false;\n        };\n      });\n    }\n\n    function incrementErrorsCount() {\n      return self.errorsSent++;\n    }\n\n    function exceedsMaxErrors() {\n      var maxErrors = config('maxErrors');\n      return maxErrors && self.errorsSent >= maxErrors;\n    }\n\n    // End of instrumentation.\n    installed = true;\n\n    // Save original state for reset()\n    for (var k in self) {\n      defaultProps.push(k);\n    }\n\n    // Initialization.\n    debug('Initializing honeybadger.js ' + VERSION);\n\n    // See https://developer.mozilla.org/en-US/docs/Web/API/Document/readyState\n    // https://www.w3.org/TR/html5/dom.html#dom-document-readystate\n    // The 'loaded' state is for older versions of Safari.\n    if (/complete|interactive|loaded/.test(document.readyState)) {\n      loaded = true;\n      debug('honeybadger.js ' + VERSION + ' ready');\n    } else {\n      debug('Installing ready handler');\n      var domReady = function() {\n        loaded = true;\n        debug('honeybadger.js ' + VERSION + ' ready');\n        var notice;\n        while (notice = queue.pop()) {\n          send(notice);\n        }\n      };\n      if (document.addEventListener) {\n        document.addEventListener('DOMContentLoaded', domReady, true);\n      } else {\n        window.attachEvent('onload', domReady);\n      }\n    }\n\n    return self;\n  });\n\n  return factory;\n}\n"],"names":["factory","currentErr","currentPayload","VERSION","NOTIFIER","name","url","version","language","loaded","installed","merge","obj1","obj2","obj3","k","mergeErr","err1","err2","ret","context","currentErrIs","err","message","stack","stackTrace","stacktrace","undefined","opts","notSingleton","defaultProps","queue","self","beforeNotifyHandlers","errorsSent","_typeof","log","console","window","args","Array","prototype","slice","call","arguments","unshift","apply","debug","config","this","key","fallback","value","toLowerCase","onErrorEnabled","request","apiKey","payload","x","XMLHttpRequest","open","baseURL","setRequestHeader","send","JSON","stringify","serialize","obj","depth","v","Object","hasOwnProperty","test","toString","maxErrors","notify","generated","e","m","String","results","push","length","patterns","msg","p","match","isIgnored","handlers","i","len","handler","checkHandlers","data","navigator","userAgent","document","referrer","cookies","object","join","encodeCookie","generator","fingerprint","URL","component","action","params","projectRoot","project_root","location","protocol","host","environment","revision","setTimeout","preferCatch","atob","ErrorEvent","colno","_e","wrap","fn","force","isExtensible","___hb","onerror","extra","Error","curr","callee","RegExp","$1","caller","generateStackTrace","func","setContext","resetContext","configure","beforeNotify","indexOf","item","l","instrument","replacement","original","reset","resetMaxErrors","getVersion","instrumentTimer","delay","replace","prop","type","listener","useCapture","wantsUntrusted","handleEvent","line","col","readyState","domReady","notice","pop","addEventListener","attachEvent","builder","singleton"],"mappings":"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"}